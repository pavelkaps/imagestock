{"version":3,"sources":["controllers/gallery-controller/gallery-controller.es6"],"names":["GalleryController","$scope","imageService","detailImageService","$mdDialog","toaster","$window","init","resizingImages","resizer","getAll","then","data","$apply","console","log","randomResizeImages","catch","ErrorHandler","openMenu","$mdMenu","event","originatorEv","open","showConfirmForDelete","ev","image","confirm","title","targetEvent","ok","cancel","show","deleteImage","deleteImageById","id","DeleteFromResizingImages","pop","toDetail","setImage","templateUrl","parent","angular","element","document","body","clickOutsideToClose","fullscreen","answer","addImage","push","randomResizeOneImage","countActions","action","count","image_likes","forEach","el","ind","arr","like_type","_id","filter","map","width","getWidthSize","height","getHeightSize","err","$inject"],"mappings":"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","file":"gallery-controller.js","sourcesContent":["import {ImageResizer} from '../../additional/ImageResizer'\r\n\r\nclass GalleryController {\r\n    constructor($scope, imageService, detailImageService, $mdDialog, toaster, $window) {\r\n        this.init($scope, imageService, detailImageService, $mdDialog, toaster, $window);\r\n    }\r\n\r\n    init($scope, imageService, detailImageService, $mdDialog, toaster, $window) {\r\n\r\n        $scope.resizingImages = [];\r\n        $scope.resizer = new ImageResizer();\r\n\r\n        imageService.getAll().then(\r\n            function (data) {\r\n                $scope.$apply(()=> {\r\n                    console.log(data);\r\n                    $scope.resizingImages = randomResizeImages(data);\r\n                    console.log($scope.resizingImages);\r\n                });\r\n            }\r\n        ).catch(ErrorHandler);\r\n\r\n        $scope.openMenu = ($mdMenu, event) => {\r\n            var originatorEv = event;\r\n            $mdMenu.open(event);\r\n        };\r\n\r\n        $scope.showConfirmForDelete = (ev, image) => {\r\n            console.log('delete dialog');\r\n            var confirm = $mdDialog.confirm()\r\n                .title('Do you want to delete this image?')\r\n                .targetEvent(ev)\r\n                .ok('Delete')\r\n                .cancel('Cancel');\r\n            $mdDialog.show(confirm).then(()=> {\r\n                deleteImage(image);\r\n            }, () => {\r\n\r\n            });\r\n        };\r\n\r\n        function deleteImage(image) {\r\n            console.log(image);\r\n            imageService.deleteImageById(image.id).then((data)=> {\r\n                if (data.ok === true) {\r\n                    DeleteFromResizingImages(image.id);\r\n                    toaster.pop('info', \"Успешно\", \"Изображение удалено\");\r\n                }\r\n            }).catch(ErrorHandler);\r\n        };\r\n\r\n        $scope.toDetail = (ev, image) => {\r\n            detailImageService.setImage(image);\r\n            $mdDialog.show({\r\n                templateUrl: './app/controllers/image-detail-controller/image-detail-controller.html',\r\n                parent: angular.element(document.body),\r\n                targetEvent: ev,\r\n                clickOutsideToClose: true,\r\n                fullscreen: false\r\n            }).then((answer) => {\r\n\r\n            }, () => {\r\n\r\n            });\r\n        };\r\n\r\n        $scope.addImage = function (ev) {\r\n            $mdDialog.show({\r\n                templateUrl: './app/controllers/add-image/add-image-controller.html',\r\n                parent: angular.element(document.body),\r\n                targetEvent: ev,\r\n                clickOutsideToClose: true,\r\n                fullscreen: false\r\n            }).then((image) => {\r\n                $scope.resizingImages.push(randomResizeOneImage(image))\r\n            }, () => {\r\n                console.log('cancel dialog');\r\n            });\r\n        };\r\n\r\n        $scope.countActions = (image, action) => {\r\n            var count = 0;\r\n            image.image_likes.forEach((el, ind, arr) => {\r\n                if (el.like_type === action) {\r\n                    count++;\r\n                }\r\n            });\r\n            return count;\r\n        };\r\n\r\n        function DeleteFromResizingImages(_id) {\r\n            $scope.$apply(()=>{\r\n                $scope.resizingImages = $scope.resizingImages.filter((data)=>{\r\n                    return data.image.id !== _id;\r\n                });\r\n            });\r\n        }\r\n\r\n        function randomResizeImages(data) {\r\n            return data.map((data) => {\r\n                return randomResizeOneImage(data);\r\n            });\r\n        }\r\n\r\n        function randomResizeOneImage(image) {\r\n            return {width: $scope.resizer.getWidthSize(), height: $scope.resizer.getHeightSize(), image: image};\r\n        }\r\n\r\n\r\n        function ErrorHandler(err){\r\n            console.log(err);\r\n            toaster.pop('info', \"Ошибка\", \"Произошла ошибка\");\r\n        }\r\n    }\r\n}\r\nGalleryController.$inject = ['$scope', 'imageService', 'detailImageService', '$mdDialog', 'toaster', '$window'];\r\nexport {GalleryController}"]}