{"version":3,"sources":["controllers/gallery-controller/gallery-controller.es6"],"names":["GalleryController","$scope","imageService","detailImageService","$mdDialog","toaster","$window","init","resizingImages","resizer","getAll","subscribe","data","console","log","randomResizeImages","$apply","openMenu","$mdMenu","event","originatorEv","open","showConfirmForDelete","ev","image","confirm","title","targetEvent","ok","cancel","show","then","deleteImage","deleteImageById","id","DeleteFromResizingImages","pop","ErrorHandler","toDetail","setImage","templateUrl","parent","angular","element","document","body","clickOutsideToClose","fullscreen","addImage","push","randomResizeOneImage","countActions","action","image_likes","filter","like","like_type","length","_id","map","width","getWidthSize","height","getHeightSize","err","$inject"],"mappings":"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","file":"gallery-controller.js","sourcesContent":["import {ImageResizer} from '../../additional/ImageResizer'\r\n\r\nclass GalleryController {\r\n    constructor($scope, imageService, detailImageService, $mdDialog, toaster, $window) {\r\n        this.init($scope, imageService, detailImageService, $mdDialog, toaster, $window);\r\n    }\r\n\r\n    init($scope, imageService, detailImageService, $mdDialog, toaster, $window) {\r\n\r\n        $scope.resizingImages = [];\r\n        $scope.resizer = new ImageResizer();\r\n\r\n        imageService.getAll().subscribe(\r\n            function (data) {\r\n                console.log(data);\r\n                $scope.resizingImages = randomResizeImages(data);\r\n                $scope.$apply();\r\n            }\r\n        );\r\n\r\n        $scope.openMenu = ($mdMenu, event) => {\r\n            var originatorEv = event;\r\n            $mdMenu.open(event);\r\n        };\r\n\r\n        $scope.showConfirmForDelete = (ev, image) => {\r\n            var confirm = $mdDialog.confirm()\r\n                .title('Do you want to delete this image?')\r\n                .targetEvent(ev)\r\n                .ok('Delete')\r\n                .cancel('Cancel');\r\n            $mdDialog.show(confirm).then(()=> {\r\n                deleteImage(image);\r\n            });\r\n        };\r\n\r\n        function deleteImage(image) {\r\n            console.log(image);\r\n            imageService.deleteImageById(image.id)\r\n                .subscribe((data)=> {\r\n                if (data.ok === true) {\r\n                    DeleteFromResizingImages(image.id);\r\n                    toaster.pop('info', \"Успешно\", \"Изображение удалено\");\r\n                    $scope.$apply();\r\n                }\r\n            }, ErrorHandler);\r\n        };\r\n\r\n        $scope.toDetail = (ev, image) => {\r\n            detailImageService.setImage(image);\r\n            $mdDialog.show({\r\n                templateUrl: './app/controllers/image-detail-controller/image-detail-controller.html',\r\n                parent: angular.element(document.body),\r\n                targetEvent: ev,\r\n                clickOutsideToClose: true,\r\n                fullscreen: false\r\n            });\r\n        };\r\n\r\n        $scope.addImage = function (ev) {\r\n            $mdDialog.show({\r\n                templateUrl: './app/controllers/add-image/add-image-controller.html',\r\n                parent: angular.element(document.body),\r\n                targetEvent: ev,\r\n                clickOutsideToClose: true,\r\n                fullscreen: false\r\n            }).then((image) => {\r\n                $scope.resizingImages.push(randomResizeOneImage(image));\r\n            });\r\n        };\r\n\r\n        $scope.countActions = (image, action) => {\r\n            return image.image_likes\r\n                .filter(like => like.like_type === action)\r\n                .length;\r\n        };\r\n\r\n        function DeleteFromResizingImages(_id) {\r\n            $scope.resizingImages = $scope.resizingImages.filter((data)=> {\r\n                return data.image.id !== _id;\r\n            });\r\n        }\r\n\r\n        function randomResizeImages(data) {\r\n            return data.map((data) => {\r\n                return randomResizeOneImage(data);\r\n            });\r\n        }\r\n\r\n        function randomResizeOneImage(image) {\r\n            return {width: $scope.resizer.getWidthSize(), height: $scope.resizer.getHeightSize(), image: image};\r\n        }\r\n\r\n\r\n        function ErrorHandler(err) {\r\n            console.log(err);\r\n            toaster.pop('info', \"Ошибка\", \"Произошла ошибка\");\r\n        }\r\n    }\r\n}\r\nGalleryController.$inject = ['$scope', 'imageService', 'detailImageService', '$mdDialog', 'toaster', '$window'];\r\nexport {GalleryController}"]}