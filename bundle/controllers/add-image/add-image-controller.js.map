{"version":3,"sources":["controllers/add-image/add-image-controller.es6"],"names":["AddImageController","$scope","$mdDialog","toaster","imageService","init","close","cancel","randomFillingImage","randomLikes","randomComments","image","addImage","_id","_attachments","image_likes","comments","setLikes","setComment","put","subscribe","console","log","hide","pop","ErrorHandler","onLoad","e","reader","file","fileList","fileObjects","fileObj","attachment","filename","content_type","filetype","data","base64","getImageData","Object","keys","openMenu","$mdMenu","event","originatorEv","open","err","$inject"],"mappings":";;;;;;;;;AAAA;;AACA;;;;IAEMA,kB;AACF,gCAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,OAA/B,EAAwCC,YAAxC,EAAsD;AAAA;;AAClD,aAAKC,IAAL,CAAUJ,MAAV,EAAkBC,SAAlB,EAA6BC,OAA7B,EAAsCC,YAAtC;AACH;;;;6BAEIH,M,EAAQC,S,EAAWC,O,EAASC,Y,EAAc;AAAA;;AAC3CH,mBAAOK,KAAP,GAAe,YAAM;AACjBJ,0BAAUK,MAAV;AACH,aAFD;;AAIA,gBAAIC,qBAAqB,4CAAzB;;AAEA,iBAAKC,WAAL,GAAmB,KAAnB;AACA,iBAAKC,cAAL,GAAsB,KAAtB;AACAT,mBAAOU,KAAP,GAAe,IAAf;;AAEAV,mBAAOW,QAAP,GAAkB,YAAM;AACpB,oBAAIX,OAAOU,KAAX,EAAkB;AACd,wBAAIA,QAAQ;AACRE,6BAAK,gBAAK,CAAL,CADG;AAERC,sCAAcb,OAAOU,KAFb;AAGRI,qCAAa,EAHL;AAIRC,kCAAU;AAJF,qBAAZ;AAMA,wBAAG,MAAKP,WAAL,KAAqB,IAAxB,EAA6B;AACzBD,2CAAmBS,QAAnB,CAA4BN,KAA5B;AACH;AACD,wBAAG,MAAKD,cAAL,KAAwB,IAA3B,EAAgC;AAC5BF,2CAAmBU,UAAnB,CAA8BP,KAA9B;AACH;AACDP,iCAAae,GAAb,CAAiBR,KAAjB,EACKS,SADL,CACe,UAACT,KAAD,EAAU;AACjBU,gCAAQC,GAAR,CAAYX,KAAZ;AACAT,kCAAUqB,IAAV,CAAeZ,KAAf;AACAR,gCAAQqB,GAAR,CAAY,MAAZ,EAAoB,SAApB,EAA+B,wBAA/B;AACH,qBALL,EAKOC,YALP;AAMH;AACJ,aArBD;;AAwBAxB,mBAAOyB,MAAP,GAAgB,UAAUC,CAAV,EAAaC,MAAb,EAAqBC,IAArB,EAA2BC,QAA3B,EAAqCC,WAArC,EAAkDC,OAAlD,EAA2D;AACvE,oBAAIC,aAAa,EAAjB;AACAA,2BAAWD,QAAQE,QAAnB,IAA+B;AAC3BC,kCAAcH,QAAQI,QADK;AAE3BC,0BAAML,QAAQM;AAFa,iBAA/B;AAIArC,uBAAOU,KAAP,GAAesB,UAAf;AACH,aAPD;;AASAhC,mBAAOsC,YAAP,GAAsB,YAAY;AAC9B,oBAAItC,OAAOU,KAAX,EAAkB;AACd,2BAAOV,OAAOU,KAAP,CAAa6B,OAAOC,IAAP,CAAYxC,OAAOU,KAAnB,EAA0B,CAA1B,CAAb,CAAP;AACH;AACJ,aAJD;;AAMAV,mBAAOyC,QAAP,GAAkB,UAACC,OAAD,EAAUC,KAAV,EAAoB;AAClC,oBAAIC,eAAeD,KAAnB;AACAD,wBAAQG,IAAR,CAAaF,KAAb;AACH,aAHD;;AAKA,qBAASnB,YAAT,CAAsBsB,GAAtB,EAA0B;AACtB1B,wBAAQC,GAAR,CAAYyB,GAAZ;AACA5C,wBAAQqB,GAAR,CAAY,MAAZ,EAAoB,QAApB,EAA8B,kBAA9B;AACH;AACJ;;;;;;AAELxB,mBAAmBgD,OAAnB,GAA6B,CAAC,QAAD,EAAW,WAAX,EAAwB,SAAxB,EAAmC,cAAnC,CAA7B;QACQhD,kB,GAAAA,kB","file":"add-image-controller.js","sourcesContent":["import {GUID} from '../../additional/GUID'\r\nimport {RandomFillingImage} from '../../additional/RandomFillingImage'\r\n\r\nclass AddImageController {\r\n    constructor($scope, $mdDialog, toaster, imageService) {\r\n        this.init($scope, $mdDialog, toaster, imageService);\r\n    }\r\n\r\n    init($scope, $mdDialog, toaster, imageService) {\r\n        $scope.close = () => {\r\n            $mdDialog.cancel();\r\n        };\r\n\r\n        var randomFillingImage = new RandomFillingImage();\r\n\r\n        this.randomLikes = false;\r\n        this.randomComments = false;\r\n        $scope.image = null;\r\n\r\n        $scope.addImage = () => {\r\n            if ($scope.image) {\r\n                var image = {\r\n                    _id: GUID(2),\r\n                    _attachments: $scope.image,\r\n                    image_likes: [],\r\n                    comments: []\r\n                };\r\n                if(this.randomLikes === true){\r\n                    randomFillingImage.setLikes(image);\r\n                }\r\n                if(this.randomComments === true){\r\n                    randomFillingImage.setComment(image);\r\n                }\r\n                imageService.put(image)\r\n                    .subscribe((image)=> {\r\n                        console.log(image);\r\n                        $mdDialog.hide(image);\r\n                        toaster.pop('info', \"Успешно\", \"Изображение добавленно\");\r\n                    }, ErrorHandler);\r\n            }\r\n        };\r\n\r\n\r\n        $scope.onLoad = function (e, reader, file, fileList, fileObjects, fileObj) {\r\n            var attachment = {};\r\n            attachment[fileObj.filename] = {\r\n                content_type: fileObj.filetype,\r\n                data: fileObj.base64\r\n            };\r\n            $scope.image = attachment;\r\n        };\r\n\r\n        $scope.getImageData = function () {\r\n            if ($scope.image) {\r\n                return $scope.image[Object.keys($scope.image)[0]];\r\n            }\r\n        };\r\n\r\n        $scope.openMenu = ($mdMenu, event) => {\r\n            var originatorEv = event;\r\n            $mdMenu.open(event);\r\n        };\r\n\r\n        function ErrorHandler(err){\r\n            console.log(err);\r\n            toaster.pop('info', \"Ошибка\", \"Произошла ошибка\");\r\n        }\r\n    }\r\n}\r\nAddImageController.$inject = ['$scope', '$mdDialog', 'toaster', 'imageService'];\r\nexport {AddImageController}"]}